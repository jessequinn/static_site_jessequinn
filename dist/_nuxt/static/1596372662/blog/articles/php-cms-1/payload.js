__NUXT_JSONP__("/blog/articles/php-cms-1", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M){return {data:[{article:{title:z,description:"A walk-through of PHP, Heroku, Mysql and the Slim microframework for web development",img:"joao-tzanno-G9_Euqxpu4k-unsplash.jpg",alt:z,featured:false,author:{name:"Jesse Quinn",bio:"All about Jesse",img:"https:\u002F\u002Fimages.unsplash.com\u002Fphoto-1533636721434-0e2d61030955?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=2550&q=80",alt:"profile photo"},publishedAt:"2019-10-28T03:00:00.000Z",updateAt:w,toc:[{id:A,depth:B,text:C},{id:D,depth:B,text:E}],body:{type:"root",children:[{type:b,tag:F,props:{id:A},children:[{type:b,tag:f,props:{href:"#introduction",ariaHidden:p,tabIndex:q},children:[{type:b,tag:r,props:{className:[s,t]},children:[]}]},{type:a,value:C}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"I have been playing around with both "},{type:b,tag:f,props:{href:"https:\u002F\u002Fwww.python.org\u002F",rel:[l,m,n],target:o},children:[{type:a,value:"Python"}]},{type:a,value:G},{type:b,tag:f,props:{href:"http:\u002F\u002Fphp.net\u002F",rel:[l,m,n],target:o},children:[{type:a,value:"PHP"}]},{type:a,value:" for web development. Although, I absolutely love Python, I found that PHP was a lot fun, more so than Python. PHP is certainly a challenging language for some, especially, with the OOP-style, controllers, middlewares, routing, frameworks, twig extensions, etc.  in comparison to what I remember 8-10 years ago when I hosted my first PHP based site along with "},{type:b,tag:f,props:{href:"https:\u002F\u002Fhttpd.apache.org\u002F",rel:[l,m,n],target:o},children:[{type:a,value:"Apache"}]},{type:a,value:" and procedural style PHP. I suppose an equally comparable language would be "},{type:b,tag:f,props:{href:"https:\u002F\u002Freactjs.org\u002F",rel:[l,m,n],target:o},children:[{type:a,value:"React"}]},{type:a,value:" (a Javascript based framework). However, today, I must say that the language has come along quite nicely, but I am not here to compare any language but rather detail the process of working with the "},{type:b,tag:f,props:{href:"http:\u002F\u002Fwww.slimframework.com\u002F",rel:[l,m,n],target:o},children:[{type:a,value:"Slim PHP Framework"}]},{type:a,value:", Eloquent, and the "},{type:b,tag:f,props:{href:"https:\u002F\u002Fwww.heroku.com\u002F",rel:[l,m,n],target:o},children:[{type:a,value:"Heroku host service"}]},{type:a,value:"."}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"To begin, I wanted to move my site from a "},{type:b,tag:f,props:{href:"http:\u002F\u002Fflask.pocoo.org\u002F",rel:[l,m,n],target:o},children:[{type:a,value:"Flask"}]},{type:a,value:" based site to a PHP content management system (CMS). So I went to the drawing board and designed an entirely new site including admin section to allow for easier posting, modifications, etc. However, the challenge was really deciding, which framework, if any, should be used for my CMS. "}]},{type:a,value:d},{type:b,tag:F,props:{id:D},children:[{type:b,tag:f,props:{href:"#slim-microframework",ariaHidden:p,tabIndex:q},children:[{type:b,tag:r,props:{className:[s,t]},children:[]}]},{type:a,value:E}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"I eventually opted to use the Slim microframework. I thought it was intuitive with decent documentation and extensibility. To work with slim, it is best to install "},{type:b,tag:f,props:{href:"https:\u002F\u002Fgetcomposer.org\u002F",rel:[l,m,n],target:o},children:[{type:a,value:"Composer"}]},{type:a,value:", a dependency manager for PHP, as a global command. This is easily accomplished with Manjaro\u002FArchlinux as Composer can be found in the extra repository. Once installed simply use the following command:"}]},{type:a,value:d},{type:b,tag:g,props:{className:[h]},children:[{type:b,tag:i,props:{className:[j,k]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"composer create-project slim\u002Fslim-skeleton [my-app-name]\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:b,tag:"strong",props:{},children:[{type:a,value:"Replace [my-app-name] with the desired directory name for your new application."}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Running a "},{type:b,tag:c,props:{},children:[{type:a,value:"tree -I vendor"}]},{type:a,value:" should produce a project structure as"}]},{type:a,value:d},{type:b,tag:g,props:{className:[h]},children:[{type:b,tag:i,props:{className:[j,k]},children:[{type:b,tag:c,props:{},children:[{type:a,value:".\n├── composer.json\n├── composer.lock\n├── CONTRIBUTING.md\n├── docker-compose.yml\n├── logs\n│   └── README.md\n├── phpunit.xml\n├── public\n│   └── index.php\n├── README.md\n├── src\n│   ├── dependencies.php\n│   ├── middleware.php\n│   ├── routes.php\n│   └── settings.php\n├── templates\n│   └── index.phtml\n└── tests\n        └── Functional\n                ├── BaseTestCase.php\n                └── HomepageTest.php\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"If you have experience with Slim then you can easily run "}]},{type:a,value:d},{type:b,tag:g,props:{className:[h]},children:[{type:b,tag:i,props:{className:[j,k]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"composer require slim\u002Fslim\n    \n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"and modify the "},{type:b,tag:c,props:{},children:[{type:a,value:x}]},{type:a,value:" with"}]},{type:a,value:d},{type:b,tag:g,props:{className:[h]},children:[{type:b,tag:i,props:{className:[j,k]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"\"scripts\": {\n    \"start\": \"php -S localhost:8888 -t public public\u002Findex.php\",\n}\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"My project folder looks like"}]},{type:a,value:d},{type:b,tag:g,props:{className:[h]},children:[{type:b,tag:i,props:{className:[j,k]},children:[{type:b,tag:c,props:{},children:[{type:a,value:".\n├── logs\n├── public\n│   ├── dist\n│   │   ├── css\n│   │   └── js\n│   ├── images\n│   └── pdf\n├── src\n│   ├── Admin\n│   ├── Blog\n│   ├── Data\n│   ├── Login\n│   ├── Registration\n│   ├── Site\n│   └── Templates\n│       ├── admin\n│       ├── blog\n│       ├── login\n│       ├── registration\n│       └── site\n└── tests\n        └── Functional\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"The "},{type:b,tag:c,props:{},children:[{type:a,value:"vendor"}]},{type:a,value:" folder is created once you have installed a package via "},{type:b,tag:c,props:{},children:[{type:a,value:"composer require"}]},{type:a,value:H},{type:b,tag:c,props:{},children:[{type:a,value:v}]},{type:a,value:" folder is where I place any file that will be web accessible such as the "},{type:b,tag:c,props:{},children:[{type:a,value:I}]},{type:a,value:H},{type:b,tag:c,props:{},children:[{type:a,value:u}]},{type:a,value:" folder contains all my php code, twig templates, etc. Obviously the "},{type:b,tag:c,props:{},children:[{type:a,value:u}]},{type:a,value:G},{type:b,tag:c,props:{},children:[{type:a,value:v}]},{type:a,value:" folders are very subjective in structure, but from what I have read and observed it is very common to follow such a structure. Within the "},{type:b,tag:c,props:{},children:[{type:a,value:u}]},{type:a,value:" folder I use many controllers and namespaces. Again, I suppose you could eliminate many of these folders and condense the code into one or two namespaces."}]},{type:a,value:d},{type:b,tag:y,props:{id:"heroku-settings"},children:[{type:b,tag:f,props:{href:"#heroku-settings",ariaHidden:p,tabIndex:q},children:[{type:b,tag:r,props:{className:[s,t]},children:[]}]},{type:a,value:"Heroku Settings"}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"To prepare for Heroku, you need to create a "},{type:b,tag:c,props:{},children:[{type:a,value:"Procfile"}]},{type:a,value:" at the top of the folder structure with your "},{type:b,tag:c,props:{},children:[{type:a,value:x}]},{type:a,value:" and it should contain either an apache or nginx web line. I like apache so I need to use:"}]},{type:a,value:d},{type:b,tag:g,props:{className:[h]},children:[{type:b,tag:i,props:{className:[j,k]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"web: vendor\u002Fbin\u002Fheroku-php-apache2 public\u002F\n"}]}]}]},{type:a,value:d},{type:b,tag:y,props:{id:"apache-settings"},children:[{type:b,tag:f,props:{href:"#apache-settings",ariaHidden:p,tabIndex:q},children:[{type:b,tag:r,props:{className:[s,t]},children:[]}]},{type:a,value:"Apache Settings"}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Also because I am using Apache, I can use "},{type:b,tag:c,props:{},children:[{type:a,value:J}]},{type:a,value:" to handle URI rewrites. Therefore, I can simply add the following information in a "},{type:b,tag:c,props:{},children:[{type:a,value:J}]},{type:a,value:" file in the "},{type:b,tag:c,props:{},children:[{type:a,value:v}]},{type:a,value:" folder if it does not already exist:"}]},{type:a,value:d},{type:b,tag:g,props:{className:[h]},children:[{type:b,tag:i,props:{className:[j,k]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"\u003CIfModule mod_rewrite.c\u003E\n    RewriteEngine On\n    # Some hosts may require you to use the `RewriteBase` directive.\n    # Determine the RewriteBase automatically and set it as environment variable.\n    # If you are using Apache aliases to do mass virtual hosting or installed the\n    # project in a subdirectory, the base path will be prepended to allow proper\n    # resolution of the index.php file and to redirect to the correct URI. It will\n    # work in environments without path prefix as well, providing a safe, one-size\n    # fits all solution. But as you do not need it in this case, you can comment\n    # the following 2 lines to eliminate the overhead.\n    RewriteCond %{REQUEST_URI}::$1 ^(\u002F.+)\u002F(.*)::\\2$\n    RewriteRule ^(.*) - [E=BASE:%1]\n\n    # If the above doesn't work you might need to set the `RewriteBase` directive manually, it should be the\n    # absolute physical path to the directory that contains this htaccess file.\n    # RewriteBase \u002F\n\n    RewriteCond %{REQUEST_FILENAME} !-f\n    RewriteRule ^ index.php [QSA,L]\n\u003C\u002FIfModule\u003E\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"The Apache documentation or "},{type:b,tag:f,props:{href:"http:\u002F\u002Fwww.slimframework.com\u002Fdocs\u002Fv3\u002Fstart\u002Fweb-servers.html",rel:[l,m,n],target:o},children:[{type:a,value:"Slim documentation"}]},{type:a,value:" covers this. "}]},{type:a,value:d},{type:b,tag:y,props:{id:"the-php-code-"},children:[{type:b,tag:f,props:{href:"#the-php-code-",ariaHidden:p,tabIndex:q},children:[{type:b,tag:r,props:{className:[s,t]},children:[]}]},{type:a,value:"The PHP Code ..."}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"I also added an "},{type:b,tag:c,props:{},children:[{type:a,value:I}]},{type:a,value:" into the "},{type:b,tag:c,props:{},children:[{type:a,value:v}]},{type:a,value:" folder with the following code:"}]},{type:a,value:d},{type:b,tag:g,props:{className:[h]},children:[{type:b,tag:i,props:{className:[j,k]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"\u003C?php\nif (PHP_SAPI == 'cli-server') {\n        \u002F\u002F To help the built-in PHP dev server, check if the request was actually for\n        \u002F\u002F something which should probably be served as a static file\n        $url = parse_url($_SERVER['REQUEST_URI']);\n        $file = __DIR__ . $url['path'];\n        if (is_file($file)) {\n                return false;\n        }\n}\n\nrequire __DIR__ . '\u002F..\u002Fvendor\u002Fautoload.php';\n\n\u002F\u002F https:\u002F\u002Fgithub.com\u002Fjohnathanmiller\u002Fsecure-env-php\nuse SecureEnvPHP\\SecureEnvPHP;\n\nif (getenv('APP_MODE') === 'Development') {\n        (new SecureEnvPHP())-\u003Eparse('.env.enc', '.env.key');\n}\n\nsession_start();\n\n\u002F\u002F Instantiate the app\n$settings = require __DIR__ . '\u002F..\u002Fsrc\u002Fsettings.php';\n$app = new \\Slim\\App($settings);\n\n\u002F\u002F Set up dependencies\nrequire __DIR__ . '\u002F..\u002Fsrc\u002Fdependencies.php';\n\n\u002F\u002F Register middleware\nrequire __DIR__ . '\u002F..\u002Fsrc\u002Fmiddleware.php';\n\n\u002F\u002F Register routes\nrequire __DIR__ . '\u002F..\u002Fsrc\u002Froutes.php';\n\n\u002F\u002F Run app\n$app-\u003Erun();\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"From this code you should be able to understand that I have required several php files from the "},{type:b,tag:c,props:{},children:[{type:a,value:u}]},{type:a,value:" folder such as "},{type:b,tag:c,props:{},children:[{type:a,value:K}]},{type:a,value:L},{type:b,tag:c,props:{},children:[{type:a,value:"dependencies.php"}]},{type:a,value:L},{type:b,tag:c,props:{},children:[{type:a,value:"middleware.php"}]},{type:a,value:", and "},{type:b,tag:c,props:{},children:[{type:a,value:"routes.php"}]},{type:a,value:". In addition, I have installed a package by  "},{type:b,tag:f,props:{href:"https:\u002F\u002Fgithub.com\u002Fjohnathanmiller\u002Fsecure-env-php",rel:[l,m,n],target:o},children:[{type:a,value:"Johnathan Miller"}]},{type:a,value:" called "},{type:b,tag:c,props:{},children:[{type:a,value:"secure-env-php"}]},{type:a,value:". This package allows me to encrypt my "},{type:b,tag:c,props:{},children:[{type:a,value:M}]},{type:a,value:" file so that I may push an encrypted version of it to Github and Heroku. However, on Heroku, I do not use "},{type:b,tag:c,props:{},children:[{type:a,value:M}]},{type:a,value:", but rather environmental variables. I also use an environmental variable APP_MODE with an assigned value of "},{type:b,tag:c,props:{},children:[{type:a,value:"Development"}]},{type:a,value:" or "},{type:b,tag:c,props:{},children:[{type:a,value:"Production"}]},{type:a,value:".  For instance, locally I could initiate the development mode by running the following command in a terminal:"}]},{type:a,value:d},{type:b,tag:g,props:{className:[h]},children:[{type:b,tag:i,props:{className:[j,k]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"export APP_MODE=Development; composer start\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Now lets move towards the "},{type:b,tag:c,props:{},children:[{type:a,value:u}]},{type:a,value:" folder. The "},{type:b,tag:c,props:{},children:[{type:a,value:K}]},{type:a,value:" file contains the following:"}]},{type:a,value:d},{type:b,tag:g,props:{className:[h]},children:[{type:b,tag:i,props:{className:[j,k]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"\u003C?php\n\nif (getenv('APP_MODE') === 'Production') {\n        \u002F\u002FGet Heroku ClearDB connection information\n        $cleardb_url = parse_url(getenv(\"CLEARDB_DATABASE_URL\"));\n        $cleardb_server = $cleardb_url[\"host\"];\n        $cleardb_username = $cleardb_url[\"user\"];\n        $cleardb_password = $cleardb_url[\"pass\"];\n        $cleardb_db = substr($cleardb_url[\"path\"], 1);\n}\n\nreturn [\n        'settings' =\u003E [\n                'displayErrorDetails' =\u003E getenv('APP_MODE') === 'Development' ? true : false, \u002F\u002F set to false in production\n                'addContentLengthHeader' =\u003E false, \u002F\u002F Allow the web server to send the content-length header\n\n                \u002F\u002F Monolog settings\n                'logger' =\u003E [\n                        'name' =\u003E 'jessequinn',\n                        'path' =\u003E getenv('APP_MODE') === 'Production' ? 'php:\u002F\u002Fstdout' : __DIR__ . '\u002F..\u002Flogs\u002Fapp.log',\n                        'level' =\u003E \\Monolog\\Logger::DEBUG,\n                ],\n\n                'db' =\u003E [\n                        \u002F\u002F Illuminate\u002Fdatabase configuration\n                        'driver' =\u003E 'mysql',\n                        'host' =\u003E getenv('APP_MODE') === 'Development' ? getenv('DB_HOST') : $cleardb_server,\n                        'database' =\u003E getenv('APP_MODE') === 'Development' ? getenv('DB_DATABASE') : $cleardb_db,\n                        'username' =\u003E getenv('APP_MODE') === 'Development' ? getenv('DB_USERNAME') : $cleardb_username,\n                        'password' =\u003E getenv('APP_MODE') === 'Development' ? getenv('DB_PASSWORD') : $cleardb_password,\n                        'charset' =\u003E 'utf8',\n                        'collation' =\u003E 'utf8_unicode_ci',\n                        'prefix' =\u003E '',\n                ],\n\n                'view' =\u003E [\n                        \u002F\u002F TWIG configuration\n                        'template_path' =\u003E __DIR__ . '\u002FTemplates\u002F',\n                        'twig' =\u003E [\n                                'cache' =\u003E __DIR__ . '\u002F..\u002Fcache\u002Ftwig',\n                                'debug' =\u003E getenv('APP_MODE') === 'Development' ? true : false,\n                                'auto_reload' =\u003E getenv('APP_MODE') === 'Development' ? true : false, \u002F\u002F development only\n                        ],\n                ],\n        ],\n];\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"Now, I am sure there are many ways to write up the settings and if you have suggestions please post a comment. I use two databases, ClearDB for production and my local MySQL for development. I also use Monolog for logging and Illuminate for database interaction through ActiveRead style controllers. You will need to install these packages and others or simply add the following to your "},{type:b,tag:c,props:{},children:[{type:a,value:x}]},{type:a,value:" and run "},{type:b,tag:c,props:{},children:[{type:a,value:"composer install"}]},{type:a,value:" to follow along with my project:"}]},{type:a,value:d},{type:b,tag:g,props:{className:[h]},children:[{type:b,tag:i,props:{className:[j,k]},children:[{type:b,tag:c,props:{},children:[{type:a,value:"\"require\": {\n        \"php\": \"\u003E=5.5.0\",\n        \"slim\u002Fslim\": \"^3.12\",\n        \"monolog\u002Fmonolog\": \"^1.17\",\n        \"twig\u002Ftwig\": \"^2.0\",\n        \"slim\u002Ftwig-view\": \"^2.4\",\n        \"slim\u002Fcsrf\": \"^0.8.3\",\n        \"slim\u002Fflash\": \"^0.4.0\",\n        \"vlucas\u002Fvalitron\": \"^1.4\",\n        \"illuminate\u002Fdatabase\": \"^5.8\",\n        \"akrabat\u002Frka-slim-session-middleware\": \"^2.0\",\n        \"johnathanmiller\u002Fsecure-env-php\": \"^2.0\",\n        \"aptoma\u002Ftwig-markdown\": \"^3.0\",\n        \"michelf\u002Fphp-markdown\": \"^1.8\",\n        \"league\u002Fcommonmark\": \"^0.18.2\",\n        \"twig\u002Fextensions\": \"^1.5\"\n},\n"}]}]}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"I will explain each package along the way."}]},{type:a,value:d},{type:b,tag:e,props:{},children:[{type:a,value:"to be continued ..."}]}]},dir:"\u002Farticles",path:"\u002Farticles\u002Fphp-cms-1",extension:".md",slug:"php-cms-1",createdAt:"2020-07-22T00:27:09.710Z",updatedAt:"2020-07-22T00:30:14.085Z"},prev:{title:"MLPs with Numpy",updateAt:w,slug:"mlp-numpy"},next:{title:"An interesting adventure with a PHP CMS \u002F\u002F Part 2",updateAt:w,slug:"php-cms-2"}}],fetch:[],mutations:[]}}("text","element","code","\n","p","a","div","nuxt-content-highlight","pre","language-text","line-numbers","nofollow","noopener","noreferrer","_blank","true",-1,"span","icon","icon-link","src","public","2020-07-19T03:00:00.000Z","composer.json","h4","An interesting adventure with a PHP CMS \u002F\u002F Part 1","introduction",3,"Introduction","slim-microframework","Slim Microframework","h3"," and ",". The ","index.php",".htaccess","settings.php",", ",".env")));